<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <title>Guía Interactiva de Derecho Romano | Versión Definitiva</title>
    <meta name="description" content="Guía interactiva de Derecho Romano para estudiantes de la Universidad de Murcia, con un diseño moderno, herramientas de IA, infografías detalladas y casos prácticos.">
    <link rel="icon" href="favicon.ico" type="image/x-icon">

    <meta property="og:title" content="Guía Interactiva de Derecho Romano">
    <meta property="og:description" content="Recursos didácticos de Derecho Romano con IA - Universidad de Murcia">
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://derechoromano.netlify.app">

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    
    <link href="https://fonts.googleapis.com/css2?family=Cormorant+Garamond:wght@400;600;700&family=Lato:wght@400;700&family=Inter:wght@400;500;600;700;900&display=swap" rel="stylesheet">
    <script src="https://cdn.tailwindcss.com"></script>
    
    <style>
        body { font-family: 'Lato', sans-serif; color: #334155; background-color: #f8fafc; }
        h1, h2, h3, .font-heading { font-family: 'Cormorant Garamond', serif; }
        .text-primary { color: #9a3412; } .text-secondary { color: #475569; }
        .loader { border: 4px solid #f3f3f3; border-top: 4px solid #d97706; border-radius: 50%; width: 30px; height: 30px; animation: spin 1s linear infinite; }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
        .sidebar-link { position: relative; transition: background-color 0.2s ease-in-out; padding-left: 1.5rem; }
        .sidebar-link::before { content: ''; position: absolute; left: 0; top: 50%; transform: translateY(-50%) scaleX(0); height: 70%; width: 4px; background-color: #f59e0b; border-radius: 2px; transition: transform 0.2s ease-in-out; transform-origin: left; }
        .sidebar-link:hover::before, .sidebar-link-active::before { transform: translateY(-50%) scaleX(1); }
        .sidebar-link-active { background-color: #334155; color: #f59e0b; }
        #content-area .prose { max-width: 900px; margin-left: auto; margin-right: auto; }
        .topic-card { background-color: #ffffff; border: 1px solid #e5e7eb; border-radius: 0.75rem; padding: 1.5rem; box-shadow: 0 4px 6px -1px rgb(0 0 0 / 0.05), 0 2px 4px -2px rgb(0 0 0 / 0.05); transition: box-shadow 0.2s ease-in-out, transform 0.2s ease-in-out; }
        .topic-card:hover { transform: translateY(-2px); box-shadow: 0 10px 15px -3px rgb(0 0 0 / 0.07), 0 4px 6px -4px rgb(0 0 0 / 0.07); }
        .topic-links { border-top: 1px solid #f3f4f6; padding-top: 1rem; margin-top: 1rem; }
        .topic-link-button { display: inline-flex; align-items: center; gap: 0.5rem; background-color: #f3f4f6; color: #4b5563; font-family: 'Inter', sans-serif; font-size: 0.875rem; font-weight: 500; padding: 0.5rem 1rem; border-radius: 9999px; text-decoration: none; transition: background-color 0.2s, color 0.2s; }
        .topic-link-button:hover { background-color: #d6d3d1; color: #1f2937; }
        details.infografia-container { border: 1px solid #e5e7eb; border-radius: 0.75rem; margin-top: 1.5rem; background-color: #ffffff; }
        details.infografia-container summary { cursor: pointer; padding: 1rem 1.5rem; font-family: 'Inter', sans-serif; font-weight: 600; color: #9a3412; display: flex; justify-content: space-between; align-items: center; transition: background-color 0.2s; }
        details.infografia-container summary:hover { background-color: #fef3c7; }
        details.infografia-container summary::-webkit-details-marker { display: none; }
        .infografia-arrow { transition: transform 0.2s; }
        details[open] .infografia-arrow { transform: rotate(180deg); }
        .infografia-content { padding: 1.5rem; border-top: 1px solid #e5e7eb; background-color: #f8fafc; }
        .error-box { background-color: #fef2f2; border: 1px solid #fecaca; border-radius: 0.5rem; padding: 1rem; margin-top: 0.5rem; }
        .error-box p { color: #991b1b; margin: 0; }
    </style>
</head>
<body class="flex min-h-screen">

    <header class="md:hidden p-4 bg-slate-800 text-white flex items-center justify-between shadow-lg z-30 fixed top-0 left-0 right-0">
        <h1 class="font-heading text-2xl font-bold text-amber-500">Derecho Romano</h1>
        <button id="menu-button" class="text-white focus:outline-none focus:ring-2 focus:ring-amber-500" aria-label="Abrir menú" aria-expanded="false">
            <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path></svg>
        </button>
    </header>

    <aside id="sidebar" class="w-64 bg-slate-800 text-white p-6 shadow-lg fixed md:relative top-0 left-0 h-full transform -translate-x-full transition-transform duration-300 ease-in-out z-20 flex-col md:flex md:translate-x-0 pt-20 overflow-y-auto" role="navigation" aria-label="Navegación principal">
        <h1 class="font-heading text-3xl font-bold text-amber-500 mb-8 hidden md:block">Derecho Romano</h1>
        <nav class="flex-grow">
            <ul class="space-y-1">
                <li><a href="#home" class="sidebar-link block p-2 rounded-md">Presentación</a></li>
                <li><a href="#bloque1" class="sidebar-link block p-2 rounded-md">Bloque I: Fundamentos</a></li>
                <li><a href="#bloque2" class="sidebar-link block p-2 rounded-md">Bloque II: Sujetos de Derecho</a></li>
                <li><a href="#bloque3" class="sidebar-link block p-2 rounded-md">Bloque III: Negocio Jurídico</a></li>
                <li><a href="#bloque4" class="sidebar-link block p-2 rounded-md">Bloque IV: Procedimiento</a></li>
                <li><a href="#bloque5" class="sidebar-link block p-2 rounded-md">Bloque V: Derechos Reales</a></li>
                <li><a href="#bloque6" class="sidebar-link block p-2 rounded-md">Bloque VI: Obligaciones y Contratos</a></li>
                <li><a href="#bloque7" class="sidebar-link block p-2 rounded-md">Bloque VII: Sucesiones</a></li>
                <li><a href="#caselab" class="sidebar-link block p-2 rounded-md">Laboratorio de Casos</a></li>
                <li><a href="#ulpiano" class="sidebar-link block p-2 rounded-md">Consulta a UlpianoIA</a></li>
                <li><a href="#bibliografia" class="sidebar-link block p-2 rounded-md">Recursos</a></li>
            </ul>
        </nav>
        <div class="mt-8 text-sm text-slate-400">
            <p>© 2025. <a href="https://webs.um.es/adiaz-bautista/" target="_blank" rel="noopener noreferrer" class="hover:underline text-amber-500">Adolfo A. Díaz-Bautista Cremades</a>. Universidad de Murcia</p>
        </div>
    </aside>

    <div id="sidebar-overlay" class="fixed inset-0 bg-black bg-opacity-50 z-10 hidden" aria-hidden="true"></div>

    <main id="content-area" class="flex-1 p-6 sm:p-8 overflow-y-auto pt-20 md:pt-8" role="main"></main>

    <div id="video-modal" class="fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center p-4 hidden z-50" role="dialog" aria-modal="true" aria-labelledby="video-modal-title">
        <div class="bg-slate-800 rounded-lg shadow-2xl p-4 max-w-4xl w-full relative">
            <h2 id="video-modal-title" class="sr-only">Video: El ADN del Derecho Romano</h2>
            <video id="modal-video-player" class="w-full rounded-lg" controls>
                <source src="El_ADN_del_Derecho_Romano.mp4" type="video/mp4">
                Tu navegador no soporta el elemento de video.
            </video>
            <button id="close-video-modal-btn" class="absolute -top-4 -right-4 bg-white rounded-full p-1 text-slate-800 hover:bg-amber-400 focus:outline-none focus:ring-2 focus:ring-white" aria-label="Cerrar video">
                <svg class="w-8 h-8" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg>
            </button>
        </div>
    </div>

    <script>
        // ========================================
        // FUNCIONES DE UTILIDAD Y SEGURIDAD
        // ========================================
        
// *** CORRECCIÓN APLICADA AQUÍ: URL BASE CORRECTA PARA RENDER ***
const API_BASE_URL = 'https://derechoromano-ecma.onrender.com';       
 function sanitizeHTML(text) {
            if (!text) return '';
            const div = document.createElement('div');
            div.textContent = text;
            return div.innerHTML;
        }

        function showError(element, errorMsg) {
            element.innerHTML = `<div class="error-box" role="alert"><p><strong>Error:</strong> ${sanitizeHTML(errorMsg)}</p></div>`;
        }

        function showLoading(element, message = 'Cargando...') {
            element.innerHTML = `<div class="flex flex-col items-center gap-2 py-4"><div class="loader" aria-hidden="true"></div><p class="text-sm text-gray-500">${sanitizeHTML(message)}</p></div>`;
        }

        async function handleButtonLoading(btnElement, loaderElement, textElement, asyncFunction) {
            textElement.classList.add('hidden');
            loaderElement.classList.remove('hidden');
            btnElement.disabled = true;
            btnElement.setAttribute('aria-busy', 'true');
            try {
                return await asyncFunction();
            } finally {
                textElement.classList.remove('hidden');
                loaderElement.classList.add('hidden');
                btnElement.disabled = false;
                btnElement.setAttribute('aria-busy', 'false');
            }
        }

        // ========================================
        // COMUNICACIÓN CON EL SERVIDOR
        // ========================================
        
       // ========================================
// REEMPLAZA TODA ESTA FUNCIÓN
// (Esta función ahora usa la variable API_BASE_URL definida arriba)
// ========================================
async function callApiAndHandleErrors(endpoint, payload) {
    try {
        const controller = new AbortController();
        const timeoutId = setTimeout(() => controller.abort(), 30000);

        // CONFIGURACIÓN CORRECTA DE FETCH
        const response = await fetch(`${API_BASE_URL}/api/${endpoint}`, {
            method: 'POST', // Especificamos que es una petición POST
            headers: {
                'Content-Type': 'application/json' // Indicamos que enviamos datos JSON
            },
            body: JSON.stringify(payload), // Convertimos el objeto de datos a texto JSON
            signal: controller.signal // Para manejar el timeout
        });

        clearTimeout(timeoutId);
        
        if (!response.ok) { 
            const errorData = await response.json().catch(() => ({})); 
            return { error: errorData.message || "Error de comunicación con el servidor." }; 
        }
        
        return await response.json();

    } catch (error) {
        if (error.name === 'AbortError') {
            return { error: "La solicitud ha tardado demasiado tiempo. Por favor, inténtalo de nuevo." };
        }
        // Este error de conexión se resolverá porque la URL ya es absoluta.
        return { error: "No se ha podido establecer conexión con el servidor." }; 
    }
}
        
        async function callGeminiAPI(promptOriginal, termino = null, currentCaseText = null) {
            if (termino && termino.length > 100) return { error: "El término es demasiado largo (máximo 100 caracteres)." };
            return await callApiAndHandleErrors('consulta', { promptOriginal, termino, currentCaseText });
        }

        // ========================================
        // ELEMENTOS DOM Y VARIABLES GLOBALES
        // ========================================
        
        const contentArea = document.getElementById('content-area');
        const sidebar = document.getElementById('sidebar');
        const menuButton = document.getElementById('menu-button');
        const sidebarOverlay = document.getElementById('sidebar-overlay');

        // ========================================
        // CONTENIDO DE LAS PÁGINAS (MAPA DE CONTENIDO)
        // ========================================
        
        const contentMap = {
            '#home': {
                title: 'Presentación',
                html: `<div class="prose"><div class="grid grid-cols-1 md:grid-cols-2 gap-x-12 items-center"><div><h2 class="text-3xl font-bold text-secondary mb-4 !mt-0">Bienvenida al curso de Derecho Romano</h2><p class="text-secondary">Esta asignatura es vuestra primera toma de contacto con el razonamiento jurídico. El objetivo principal es que aprendáis a identificar problemas, a encontrar la norma o principio aplicable y a argumentar una solución.</p><p class="text-secondary mb-6">Este enfoque será la base de vuestra evaluación y de vuestra formación como juristas.</p><a href="0. presentacion.pdf" target="_blank" rel="noopener noreferrer" class="no-prose inline-block bg-amber-600 text-white font-bold py-2 px-5 rounded-lg hover:bg-amber-700 transition-colors no-underline mb-8">Ver Presentación de la Asignatura</a></div><div class="not-prose mt-6 md:mt-0"><button id="open-video-modal-btn" class="relative w-full max-w-md mx-auto rounded-lg overflow-hidden group focus:outline-none focus:ring-4 focus:ring-amber-500 shadow-xl" aria-label="Ver video de presentación"><img src="video_preview.jpg" alt="Vista previa del vídeo sobre Derecho Romano" class="w-full h-auto"><div class="absolute inset-0 bg-black bg-opacity-40 group-hover:bg-opacity-20 transition-all duration-300 flex items-center justify-center"><svg class="w-16 h-16 text-white opacity-80 group-hover:opacity-100 transform group-hover:scale-110 transition-transform" fill="currentColor" viewBox="0 0 20 20"><path d="M10 18a8 8 0 100-16 8 8 0 000 16zM9.555 7.168A1 1 0 008 8v4a1 1 0 001.555.832l3-2a1 1 0 000-1.664l-3-2z"></path></svg></div></button></div></div><h3 class="text-2xl font-semibold text-secondary mt-12 mb-2">Metodología y Recursos</h3><p class="text-secondary">Para facilitar vuestro aprendizaje, hemos preparado una serie de guiones y recursos. Es fundamental que los uséis como un mapa de estudio antes de cada clase junto con el manual, completándolos con las explicaciones del profesor.</p></div>`
            },
            '#caselab': {
                title: 'Laboratorio de Casos',
                html: `<section class="infographic-font bg-white rounded-lg shadow-md p-6"><h2 class="text-3xl font-bold text-center text-[#900C3F] mb-4">Laboratorio de Casos Romanos</h2><p class="text-center max-w-4xl mx-auto mb-6">Introduce un concepto de derecho romano (ej: usufructo, dote, compraventa) y la IA generará un caso de estudio para que lo analices.</p><div class="text-center text-sm text-gray-500 mb-6 bg-amber-50 border border-amber-200 rounded-lg p-3 max-w-xl mx-auto"><p><strong>Advertencia:</strong> Los casos y soluciones son generados por la IA de Google (Gemini) y no han sido supervisados por el profesor. Úsalos como una herramienta de práctica y no como una fuente autorizada.</p></div><div class="max-w-xl mx-auto"><div class="flex flex-col sm:flex-row gap-2"><input type="text" id="case-study-input" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#FF5733]" placeholder="Ej: Usufructo" maxlength="100" aria-label="Concepto de derecho romano"><button id="generate-case-btn" class="bg-[#C70039] text-white font-bold py-2 px-6 rounded-lg hover:bg-[#900C3F] transition-colors flex items-center justify-center" aria-busy="false"><span id="btn-text">✨ Generar Caso</span><div id="btn-loader" class="loader hidden" style="width:20px; height:20px; border-width:3px;" aria-hidden="true"></div></button></div><div id="case-study-result" class="mt-6 p-4 bg-gray-50 rounded-lg border border-gray-200 min-h-[100px]" role="region" aria-live="polite" aria-atomic="true"><p class="text-gray-500">Aquí aparecerá tu caso de estudio...</p></div><div class="text-center mt-4"><button id="solve-case-btn" class="hidden bg-[#FF5733] text-white font-bold py-2 px-6 rounded-lg hover:bg-[#C70039] transition-colors flex items-center justify-center mx-auto" aria-busy="false"><span id="solve-btn-text">Ver Solución</span><div id="solve-btn-loader" class="loader hidden" style="width:20px; height:20px; border-width:3px;" aria-hidden="true"></div></button></div><div id="case-solution-result" class="hidden mt-6 p-4 bg-green-50 rounded-lg border border-green-200" role="region" aria-live="polite" aria-atomic="true"></div></div></section>`
            },
            '#ulpiano': {
                title: 'Consulta a UlpianoIA',
                html: `<section class="infographic-font bg-white rounded-lg shadow-md p-6" style="color: #333;"><h2 class="text-3xl font-bold text-center text-[#900C3F] mb-4">Consulta a UlpianoIA</h2><p class="text-center max-w-4xl mx-auto mb-6">Hazle una pregunta a UlpianoIA sobre cualquier tema de Derecho Romano.</p><div class="text-center text-sm text-gray-500 mb-6 bg-amber-50 border border-amber-200 rounded-lg p-3 max-w-xl mx-auto"><p><strong>Advertencia:</strong> Las respuestas de Ulpiano son generadas por la IA de Google (Gemini) y no han sido supervisadas por el profesor. Úsalas como una herramienta de apoyo y no como una fuente autorizada para tus exámenes.</p></div><div class="max-w-xl mx-auto"><div class="flex flex-col sm:flex-row gap-2"><textarea id="queryInput" rows="4" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#FF5733]" placeholder="Escribe tu pregunta aquí..." maxlength="500" aria-label="Tu pregunta sobre Derecho Romano"></textarea><button id="submitQueryBtn" class="bg-[#C70039] text-white font-bold py-2 px-6 rounded-lg hover:bg-[#900C3F] transition-colors flex items-center justify-center" aria-busy="false"><span id="submit-btn-text">✨ Enviar consulta</span><div id="submit-btn-loader" class="loader hidden" style="border-top-color: #fff; width:20px; height:20px; border-width:3px;" aria-hidden="true"></div></button></div><div id="queryResult" class="mt-6 p-4 bg-gray-50 rounded-lg border border-gray-200 hidden" role="region" aria-live="polite" aria-atomic="true"><h3 class="text-xl font-semibold mb-2 text-[#900C3F]">Respuesta de UlpianoIA:</h3><div id="queryResultText"></div></div></div></section>`
            },
            '#bloque1': {
                title: 'Bloque I: Fundamentos',
                html: `<div class="prose"><p class="text-secondary">Este bloque introduce los conceptos más básicos para comprender el Derecho. Exploraremos la diferencia entre los distintos tipos de normas de conducta, la aportación fundamental de Roma al Derecho y su evolución histórica, así como su pervivencia hasta nuestros días.</p></div><details class="infografia-container"><summary><span>📊 Ver Infografía: Las Fuentes del Derecho Romano</span><svg class="w-6 h-6 infografia-arrow" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M19.5 8.25l-7.5 7.5-7.5-7.5"></path></svg></summary><div class="infografia-content grid grid-cols-1 md:grid-cols-4 gap-6 text-center"><div class="bg-slate-100 p-4 rounded-lg"><h4 class="font-bold text-sm text-primary">MONARQUÍA</h4><p class="text-xs mt-1 text-secondary"><strong>Mores Maiorum:</strong> Costumbres de los antepasados. Derecho no escrito y tradicional.</p></div><div class="bg-slate-100 p-4 rounded-lg"><h4 class="font-bold text-sm text-primary">REPÚBLICA</h4><p class="text-xs mt-1 text-secondary"><strong>Ley XII Tablas:</strong> Primera codificación. <strong>Leyes y Plebiscitos.</strong> <strong>Edicto del Pretor.</strong></p></div><div class="bg-slate-100 p-4 rounded-lg"><h4 class="font-bold text-sm text-primary">PRINCIPADO</h4><p class="text-xs mt-1 text-secondary"><strong>Jurisprudencia:</strong> Dictámenes de los juristas. <strong>Senadoconsultos.</strong></p></div><div class="bg-slate-100 p-4 rounded-lg"><h4 class="font-bold text-sm text-primary">DOMINADO</h4><p class="text-xs mt-1 text-secondary"><strong>Constituciones Imperiales.</strong> <strong>Corpus Iuris Civilis.</strong></p></div></div></details><div class="space-y-4 mt-8"><div class="topic-card"><h4 class="text-xl font-semibold text-primary mb-2 font-heading">Tema 1: Ideas fundamentales</h4><p class="text-secondary mb-3 text-sm">Aborda las nociones primarias del Derecho, diferenciando entre distintas normas de conducta y sentando las bases del pensamiento jurídico.</p><div class="topic-links flex flex-wrap gap-4"><a href="1. introduccion.pdf" target="_blank" class="topic-link-button"><svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M4 4a2 2 0 012-2h4.586A2 2 0 0112 2.586L15.414 6A2 2 0 0116 7.414V16a2 2 0 01-2 2H6a2 2 0 01-2-2V4zm2 6a1 1 0 011-1h6a1 1 0 110 2H7a1 1 0 01-1-1zm1 3a1 1 0 100 2h6a1 1 0 100-2H7z" clip-rule="evenodd" /></svg><span>Ver Guion</span></a><a href="https://open.spotify.com/episode/3015" target="_blank" class="topic-link-button"><svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor"><path d="M10 18a8 8 0 100-16 8 8 0 000 16zM9.555 7.168A1 1 0 008 8v4a1 1 0 001.555.832l3-2a1 1 0 000-1.664l-3-2z" /></svg><span>Escuchar Podcast</span></a></div></div><div class="topic-card"><h4 class="text-xl font-semibold text-primary mb-2 font-heading">Tema 2: Historia del Derecho Romano</h4><p class="text-secondary mb-3 text-sm">Presenta la evolución histórica del Derecho Romano, desde la época arcaica hasta la compilación justinianea.</p><div class="topic-links flex flex-wrap gap-4"><a href="2. historia.pdf" target="_blank" class="topic-link-button"><svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M4 4a2 2 0 012-2h4.586A2 2 0 0112 2.586L15.414 6A2 2 0 0116 7.414V16a2 2 0 01-2 2H6a2 2 0 01-2-2V4zm2 6a1 1 0 011-1h6a1 1 0 110 2H7a1 1 0 01-1-1zm1 3a1 1 0 100 2h6a1 1 0 100-2H7z" clip-rule="evenodd" /></svg><span>Ver Guion</span></a><a href="https://open.spotify.com/episode/3015" target="_blank" class="topic-link-button"><svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor"><path d="M10 18a8 8 0 100-16 8 8 0 000 16zM9.555 7.168A1 1 0 008 8v4a1 1 0 001.555.832l3-2a1 1 0 000-1.664l-3-2z" /></svg><span>Escuchar Podcast</span></a></div></div><div class="topic-card"><h4 class="text-xl font-semibold text-primary mb-2 font-heading">Tema 3: Persistencia del Derecho Romano</h4><p class="text-secondary mb-3 text-sm">Analiza la pervivencia del Derecho Romano y su influencia en los sistemas jurídicos modernos.</p><div class="topic-links flex flex-wrap gap-4"><a href="3. persistencia.pdf" target="_blank" class="topic-link-button"><svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M4 4a2 2 0 012-2h4.586A2 2 0 0112 2.586L15.414 6A2 2 0 0116 7.414V16a2 2 0 01-2 2H6a2 2 0 01-2-2V4zm2 6a1 1 0 011-1h6a1 1 0 110 2H7a1 1 0 01-1-1zm1 3a1 1 0 100 2h6a1 1 0 100-2H7z" clip-rule="evenodd" /></svg><span>Ver Guion</span></a><a href="https://open.spotify.com/episode/3015" target="_blank" class="topic-link-button"><svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor"><path d="M10 18a8 8 0 100-16 8 8 0 000 16zM9.555 7.168A1 1 0 008 8v4a1 1 0 001.555.832l3-2a1 1 0 000-1.664l-3-2z" /></svg><span>Escuchar Podcast</span></a></div></div></div>` 
            },
            '#bloque2': {
                title: 'Bloque II: Sujetos de Derecho',
                html: `<div class="prose"><p class="text-secondary">Este bloque se centra en quiénes son los protagonistas del Derecho. Analizaremos los requisitos para ser persona en Roma, la estructura de la familia y los poderes que ostentaba el paterfamilias.</p></div><details class="infografia-container"><summary><span>📊 Ver Infografía: El Status de la Persona</span><svg class="w-6 h-6 infografia-arrow" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M19.5 8.25l-7.5 7.5-7.5-7.5"></path></svg></summary><div class="infografia-content flex flex-col md:flex-row items-center justify-around gap-4"><div class="text-center p-4 bg-slate-100 rounded-lg"><h4 class="font-bold text-primary">Status Libertatis</h4><p class="text-secondary text-sm">¿Libre o Esclavo?</p><div class="text-2xl mt-2">🕊️ vs ⛓️</div></div><div class="text-2xl text-gray-300 font-bold">→</div><div class="text-center p-4 bg-slate-100 rounded-lg"><h4 class="font-bold text-primary">Status Civitatis</h4><p class="text-secondary text-sm">¿Ciudadano o Extranjero?</p><div class="text-2xl mt-2">🏛️ vs 🌍</div></div><div class="text-2xl text-gray-300 font-bold">→</div><div class="text-center p-4 bg-slate-100 rounded-lg"><h4 class="font-bold text-primary">Status Familiae</h4><p class="text-secondary text-sm">¿Jefe de Familia o Sometido?</p><div class="text-2xl mt-2">👑 vs 👨‍👩‍👧</div></div></div></details><div class="space-y-4 mt-8"><div class="topic-card"><h4 class="text-xl font-semibold text-primary mb-2 font-heading">Tema 4: El sujeto del derecho</h4><p class="text-secondary mb-3 text-sm">Estudio de los requisitos para ostentar la condición de persona y ser sujeto de derechos en Roma.</p><div class="topic-links flex flex-wrap gap-4"><a href="4. persona.pdf" target="_blank" class="topic-link-button"><svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M4 4a2 2 0 012-2h4.586A2 2 0 0112 2.586L15.414 6A2 2 0 0116 7.414V16a2 2 0 01-2 2H6a2 2 0 01-2-2V4zm2 6a1 1 0 011-1h6a1 1 0 110 2H7a1 1 0 01-1-1zm1 3a1 1 0 100 2h6a1 1 0 100-2H7z" clip-rule="evenodd" /></svg><span>Ver Guion</span></a><a href="https://open.spotify.com/episode/6D2mPBSBGo8AcyGWXO914i?si=btU9P3-nRryXxr_vFvu0Kw" target="_blank" class="topic-link-button"><svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor"><path d="M10 18a8 8 0 100-16 8 8 0 000 16zM9.555 7.168A1 1 0 008 8v4a1 1 0 001.555.832l3-2a1 1 0 000-1.664l-3-2z" /></svg><span>Escuchar Podcast</span></a></div></div><div class="topic-card"><h4 class="text-xl font-semibold text-primary mb-2 font-heading">Tema 5: La familia</h4><p class="text-secondary mb-3 text-sm">Análisis de la organización familiar romana, una estructura social y jurídica fundamental.</p><div class="topic-links flex flex-wrap gap-4"><a href="5. familia.pdf" target="_blank" class="topic-link-button"><svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M4 4a2 2 0 012-2h4.586A2 2 0 0112 2.586L15.414 6A2 2 0 0116 7.414V16a2 2 0 01-2 2H6a2 2 0 01-2-2V4zm2 6a1 1 0 011-1h6a1 1 0 110 2H7a1 1 0 01-1-1zm1 3a1 1 0 100 2h6a1 1 0 100-2H7z" clip-rule="evenodd" /></svg><span>Ver Guion</span></a><a href="https://open.spotify.com/episode/677MZlIOUO1eCMyec6AtnZ?si=9etnCEy0S92jHp88-NXWog" target="_blank" class="topic-link-button"><svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor"><path d="M10 18a8 8 0 100-16 8 8 0 000 16zM9.555 7.168A1 1 0 008 8v4a1 1 0 001.555.832l3-2a1 1 0 000-1.664l-3-2z" /></svg><span>Escuchar Podcast</span></a></div></div></div>`
            },
            '#bloque3': {
                title: 'Bloque III: Negocio Jurídico',
                html: `<div class="prose"><p class="text-secondary">Este bloque es crucial para la comprensión de los actos voluntarios con efectos jurídicos. Analizaremos los elementos esenciales y accidentales de los negocios jurídicos y las causas que pueden llevar a su ineficacia.</p></div><details class="infografia-container"><summary><span>📊 Ver Infografía: Anatomía del Negocio Jurídico</span><svg class="w-6 h-6 infografia-arrow" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M19.5 8.25l-7.5 7.5-7.5-7.5"></path></svg></summary><div class="infografia-content grid grid-cols-1 md:grid-cols-3 gap-4"><div class="bg-slate-100 p-4 rounded-lg"><h4 class="font-bold text-primary">Elementos Esenciales</h4><ul class="text-sm text-secondary list-disc list-inside"><li><strong>Voluntad:</strong> El querer interno.</li><li><strong>Objeto:</strong> La cosa o hecho.</li><li><strong>Causa:</strong> El fin económico-social.</li></ul></div><div class="bg-slate-100 p-4 rounded-lg"><h4 class="font-bold text-primary">Elementos Accidentales</h4><ul class="text-sm text-secondary list-disc list-inside"><li><strong>Condición:</strong> Hecho futuro e incierto.</li><li><strong>Término:</strong> Hecho futuro y cierto.</li><li><strong>Modo:</strong> Carga impuesta.</li></ul></div><div class="bg-slate-100 p-4 rounded-lg"><h4 class="font-bold text-primary">Vicios de la Voluntad</h4><ul class="text-sm text-secondary list-disc list-inside"><li><strong>Error:</strong> Falso conocimiento.</li><li><strong>Dolo:</strong> Engaño malicioso.</li><li><strong>Violencia (Metus):</strong> Amenaza.</li></ul></div></div></details><div class="space-y-4 mt-8"><div class="topic-card"><h4 class="text-xl font-semibold text-primary mb-2 font-heading">Tema 6: Hechos, actos y negocios jurídicos</h4><p class="text-secondary mb-3 text-sm">Se exploran las bases de los negocios jurídicos, sus elementos esenciales y accidentales.</p><div class="topic-links flex flex-wrap gap-4"><a href="6. negocio.pdf" target="_blank" class="topic-link-button"><svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M4 4a2 2 0 012-2h4.586A2 2 0 0112 2.586L15.414 6A2 2 0 0116 7.414V16a2 2 0 01-2 2H6a2 2 0 01-2-2V4zm2 6a1 1 0 011-1h6a1 1 0 110 2H7a1 1 0 01-1-1zm1 3a1 1 0 100 2h6a1 1 0 100-2H7z" clip-rule="evenodd" /></svg><span>Ver Guion</span></a><a href="http://googleusercontent.com/spotify.com/3" target="_blank" class="topic-link-button"><svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor"><path d="M10 18a8 8 0 100-16 8 8 0 000 16zM9.555 7.168A1 1 0 008 8v4a1 1 0 001.555.832l3-2a1 1 0 000-1.664l-3-2z" /></svg><span>Escuchar Podcast</span></a></div></div><div class="topic-card"><h4 class="text-xl font-semibold text-primary mb-2 font-heading">Tema 7: Ineficacia del negocio jurídico</h4><p class="text-secondary mb-3 text-sm">Estudio de las causas que impiden a un negocio jurídico producir sus efectos (nulidad y anulabilidad).</p><div class="topic-links flex flex-wrap gap-4"><a href="7. ineficacia.pdf" target="_blank" class="topic-link-button"><svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M4 4a2 2 0 012-2h4.586A2 2 0 0112 2.586L15.414 6A2 2 0 0116 7.414V16a2 2 0 01-2 2H6a2 2 0 01-2-2V4zm2 6a1 1 0 011-1h6a1 1 0 110 2H7a1 1 0 01-1-1zm1 3a1 1 0 100 2h6a1 1 0 100-2H7z" clip-rule="evenodd" /></svg><span>Ver Guion</span></a><a href="http://googleusercontent.com/spotify.com/4" target="_blank" class="topic-link-button"><svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor"><path d="M10 18a8 8 0 100-16 8 8 0 000 16zM9.555 7.168A1 1 0 008 8v4a1 1 0 001.555.832l3-2a1 1 0 000-1.664l-3-2z" /></svg><span>Escuchar Podcast</span></a></div></div></div>` 
            },
            '#bloque4': {
                title: 'Bloque IV: Procedimiento',
                html: `<div class="prose"><p class="text-secondary">En este bloque nos adentraremos en el procedimiento para hacer valer los derechos en Roma, desde las acciones de la ley hasta el procedimiento cognitio extra ordinem. Comprenderemos la importancia de la fórmula en el proceso clásico.</p></div><details class="infografia-container"><summary><span>📊 Ver Infografía: Fases del Procedimiento Romano</span><svg class="w-6 h-6 infografia-arrow" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M19.5 8.25l-7.5 7.5-7.5-7.5"></path></svg></summary><div class="infografia-content grid grid-cols-1 md:grid-cols-2 gap-4"><div class="bg-slate-100 p-4 rounded-lg"><h4 class="font-bold text-primary">Fase in iure (ante el magistrado)</h4><ul class="text-sm text-secondary list-disc list-inside"><li>Comparecencia.</li><li>Concesión de la acción.</li><li>**Litis Contestatio:** Fijación definitiva de la controversia.</li></ul></div><div class="bg-slate-100 p-4 rounded-lg"><h4 class="font-bold text-primary">Fase apud iudicem (ante el juez)</h4><ul class="text-sm text-secondary list-disc list-inside"><li>Prueba de los hechos.</li><li>Alegaciones de las partes.</li><li>**Sentencia:** El juez decide.</li></ul></div></div></details><div class="space-y-4 mt-8"><div class="topic-card"><h4 class="text-xl font-semibold text-primary mb-2 font-heading">Tema 8: Acciones y derecho procesal</h4><p class="text-secondary mb-3 text-sm">Visión general de las acciones y el procedimiento como medio para proteger los derechos.</p><div class="topic-links flex flex-wrap gap-4"><a href="8. procesal.pdf" target="_blank" class="topic-link-button"><svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M4 4a2 2 0 012-2h4.586A2 2 0 0112 2.586L15.414 6A2 2 0 0116 7.414V16a2 2 0 01-2 2H6a2 2 0 01-2-2V4zm2 6a1 1 0 011-1h6a1 1 0 110 2H7a1 1 0 01-1-1zm1 3a1 1 0 100 2h6a1 1 0 100-2H7z" clip-rule="evenodd" /></svg><span>Ver Guion</span></a><a href="http://googleusercontent.com/spotify.com/5" target="_blank" class="topic-link-button"><svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor"><path d="M10 18a8 8 0 100-16 8 8 0 000 16zM9.555 7.168A1 1 0 008 8v4a1 1 0 001.555.832l3-2a1 1 0 000-1.664l-3-2z" /></svg><span>Escuchar Podcast</span></a></div></div></div>` 
            },
            '#bloque5': {
                title: 'Bloque V: Derechos Reales',
                html: `<div class="prose"><p class="text-secondary">Este bloque introduce los derechos que se ejercen directamente sobre las cosas, comenzando por el derecho de propiedad, la distinción con la posesión y los demás derechos reales limitados (servidumbres, usufructo, etc.).</p></div><details class="infografia-container"><summary><span>📊 Ver Infografía: Derechos Reales y de Obligación</span><svg class="w-6 h-6 infografia-arrow" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M19.5 8.25l-7.5 7.5-7.5-7.5"></path></svg></summary><div class="infografia-content grid grid-cols-1 md:grid-cols-2 gap-4"><div class="bg-slate-100 p-4 rounded-lg"><h4 class="font-bold text-primary">Derechos Reales (iura in re)</h4><ul class="text-sm text-secondary list-disc list-inside"><li>**Sujeto:** Titular. **Objeto:** Cosa.</li><li>**Efectos:** Erga omnes (frente a todos).</li><li>**Ejemplos:** Propiedad, Usufructo.</li></ul></div><div class="bg-slate-100 p-4 rounded-lg"><h4 class="font-bold text-primary">Derechos de Obligación (iura ad rem)</h4><ul class="text-sm text-secondary list-disc list-inside"><li>**Sujeto:** Deudor y Acreedor. **Objeto:** Prestación.</li><li>**Efectos:** Inter partes (solo entre las partes).</li><li>**Ejemplos:** Compraventa, Arrendamiento.</li></ul></div></div></details><div class="space-y-4 mt-8"><div class="topic-card"><h4 class="text-xl font-semibold text-primary mb-2 font-heading">Tema 9: Derechos reales y cosas</h4><p class="text-secondary mb-3 text-sm">Diferenciación entre derechos reales y de obligación, y clasificación de las cosas (res).</p><div class="topic-links flex flex-wrap gap-4"><a href="9. reales-cosas.pdf" target="_blank" class="topic-link-button"><svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M4 4a2 2 0 012-2h4.586A2 2 0 0112 2.586L15.414 6A2 2 0 0116 7.414V16a2 2 0 01-2 2H6a2 2 0 01-2-2V4zm2 6a1 1 0 011-1h6a1 1 0 110 2H7a1 1 0 01-1-1zm1 3a1 1 0 100 2h6a1 1 0 100-2H7z" clip-rule="evenodd" /></svg><span>Ver Guion</span></a><a href="http://googleusercontent.com/spotify.com/6" target="_blank" class="topic-link-button"><svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor"><path d="M10 18a8 8 0 100-16 8 8 0 000 16zM9.555 7.168A1 1 0 008 8v4a1 1 0 001.555.832l3-2a1 1 0 000-1.664l-3-2z" /></svg><span>Escuchar Podcast</span></a></div></div><div class="topic-card"><h4 class="text-xl font-semibold text-primary mb-2 font-heading">Tema 10: Propiedad y posesión</h4><p class="text-secondary mb-3 text-sm">Estudio de la propiedad, sus clases y limitaciones, y la distinción fundamental con la posesión.</p><div class="topic-links flex flex-wrap gap-4"><a href="10. propiedad.pdf" target="_blank" class="topic-link-button"><svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M4 4a2 2 0 012-2h4.586A2 2 0 0112 2.586L15.414 6A2 2 0 0116 7.414V16a2 2 0 01-2 2H6a2 2 0 01-2-2V4zm2 6a1 1 0 011-1h6a1 1 0 110 2H7a1 1 0 01-1-1zm1 3a1 1 0 100 2h6a1 1 0 100-2H7z" clip-rule="evenodd" /></svg><span>Ver Guion</span></a><a href="http://googleusercontent.com/spotify.com/7" target="_blank" class="topic-link-button"><svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor"><path d="M10 18a8 8 0 100-16 8 8 0 000 16zM9.555 7.168A1 1 0 008 8v4a1 1 0 001.555.832l3-2a1 1 0 000-1.664l-3-2z" /></svg><span>Escuchar Podcast</span></a></div></div><div class="topic-card"><h4 class="text-xl font-semibold text-primary mb-2 font-heading">Tema 11: Derechos reales limitados</h4><p class="text-secondary mb-3 text-sm">Análisis de los derechos que recaen sobre una cosa ajena (servidumbres, usufructo, enfiteusis y superficie).</p><div class="topic-links flex flex-wrap gap-4"><a href="11. derechos-reales.pdf" target="_blank" class="topic-link-button"><svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M4 4a2 2 0 012-2h4.586A2 2 0 0112 2.586L15.414 6A2 2 0 0116 7.414V16a2 2 0 01-2 2H6a2 2 0 01-2-2V4zm2 6a1 1 0 011-1h6a1 1 0 110 2H7a1 1 0 01-1-1zm1 3a1 1 0 100 2h6a1 1 0 100-2H7z" clip-rule="evenodd" /></svg><span>Ver Guion</span></a><a href="http://googleusercontent.com/spotify.com/8" target="_blank" class="topic-link-button"><svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor"><path d="M10 18a8 8 0 100-16 8 8 0 000 16zM9.555 7.168A1 1 0 008 8v4a1 1 0 001.555.832l3-2a1 1 0 000-1.664l-3-2z" /></svg><span>Escuchar Podcast</span></a></div></div></div>` 
            },
            '#bloque6': {
                title: 'Bloque VI: Obligaciones y Contratos',
                html: `<div class="prose"><p class="text-secondary">Este bloque aborda la esencia de las obligaciones, sus fuentes y su cumplimiento e incumplimiento. Además, analizaremos los principales tipos de contratos consensuales y reales.</p></div><details class="infografia-container"><summary><span>📊 Ver Infografía: Clasificación de los Contratos</span><svg class="w-6 h-6 infografia-arrow" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M19.5 8.25l-7.5 7.5-7.5-7.5"></path></svg></summary><div class="infografia-content grid grid-cols-1 md:grid-cols-2 gap-4"><div class="bg-slate-100 p-4 rounded-lg"><h4 class="font-bold text-primary">Contratos Consensuales</h4><ul class="text-sm text-secondary list-disc list-inside"><li>Se perfeccionan por el mero **consentimiento**.</li><li>**Ejemplos:** Compraventa, Arrendamiento, Sociedad, Mandato.</li></ul></div><div class="bg-slate-100 p-4 rounded-lg"><h4 class="font-bold text-primary">Contratos Reales</h4><ul class="text-sm text-secondary list-disc list-inside"><li>Se perfeccionan con la entrega de la **cosa**.</li><li>**Ejemplos:** Mutuo, Comodato, Depósito, Prenda.</li></ul></div></div></details><div class="space-y-4 mt-8"><div class="topic-card"><h4 class="text-xl font-semibold text-primary mb-2 font-heading">Tema 12: Obligaciones: concepto y fuentes</h4><p class="text-secondary mb-3 text-sm">Definición de obligación, sus fuentes (contratos, delitos, etc.) y elementos (sujeto y objeto).</p><div class="topic-links flex flex-wrap gap-4"><a href="12. obligaciones.pdf" target="_blank" class="topic-link-button"><svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M4 4a2 2 0 012-2h4.586A2 2 0 0112 2.586L15.414 6A2 2 0 0116 7.414V16a2 2 0 01-2 2H6a2 2 0 01-2-2V4zm2 6a1 1 0 011-1h6a1 1 0 110 2H7a1 1 0 01-1-1zm1 3a1 1 0 100 2h6a1 1 0 100-2H7z" clip-rule="evenodd" /></svg><span>Ver Guion</span></a><a href="http://googleusercontent.com/spotify.com/9" target="_blank" class="topic-link-button"><svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor"><path d="M10 18a8 8 0 100-16 8 8 0 000 16zM9.555 7.168A1 1 0 008 8v4a1 1 0 001.555.832l3-2a1 1 0 000-1.664l-3-2z" /></svg><span>Escuchar Podcast</span></a></div></div><div class="topic-card"><h4 class="text-xl font-semibold text-primary mb-2 font-heading">Tema 13: El incumplimiento de las obligaciones</h4><p class="text-secondary mb-3 text-sm">Estudio de la mora, el dolo, la culpa y el caso fortuito como causas del incumplimiento y sus consecuencias.</p><div class="topic-links flex flex-wrap gap-4"><a href="13. incumplimiento.pdf" target="_blank" class="topic-link-button"><svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M4 4a2 2 0 012-2h4.586A2 2 0 0112 2.586L15.414 6A2 2 0 0116 7.414V16a2 2 0 01-2 2H6a2 2 0 01-2-2V4zm2 6a1 1 0 011-1h6a1 1 0 110 2H7a1 1 0 01-1-1zm1 3a1 1 100 2h6a1 1 0 100-2H7z" clip-rule="evenodd" /></svg><span>Ver Guion</span></a><a href="https://open.spotify.com/episode/6D2mPBSBGo8AcyGWXO914i?si=btU9P3-nRryXxr_vFvu0Kw0" target="_blank" class="topic-link-button"><svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor"><path d="M10 18a8 8 0 100-16 8 8 0 000 16zM9.555 7.168A1 1 0 008 8v4a1 1 0 001.555.832l3-2a1 1 0 000-1.664l-3-2z" /></svg><span>Escuchar Podcast</span></a></div></div><div class="topic-card"><h4 class="text-xl font-semibold text-primary mb-2 font-heading">Tema 14: Contratos</h4><p class="text-secondary mb-3 text-sm">Análisis detallado de los principales contratos romanos (compraventa, arrendamiento, sociedad, etc.).</p><div class="topic-links flex flex-wrap gap-4"><a href="14. contratos.pdf" target="_blank" class="topic-link-button"><svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M4 4a2 2 0 012-2h4.586A2 2 0 0112 2.586L15.414 6A2 2 0 0116 7.414V16a2 2 0 01-2 2H6a2 2 0 01-2-2V4zm2 6a1 1 0 011-1h6a1 1 0 110 2H7a1 1 0 01-1-1zm1 3a1 1 0 100 2h6a1 1 0 100-2H7z" clip-rule="evenodd" /></svg><span>Ver Guion</span></a><a href="https://open.spotify.com/episode/6D2mPBSBGo8AcyGWXO914i?si=btU9P3-nRryXxr_vFvu0Kw1" target="_blank" class="topic-link-button"><svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor"><path d="M10 18a8 8 0 100-16 8 8 0 000 16zM9.555 7.168A1 1 0 008 8v4a1 1 0 001.555.832l3-2a1 1 0 000-1.664l-3-2z" /></svg><span>Escuchar Podcast</span></a></div></div></div>` 
            },
            '#bloque7': {
                title: 'Bloque VII: Sucesiones',
                html: `<div class="prose"><p class="text-secondary">El último bloque se centra en el Derecho de Sucesiones, la transmisión del patrimonio tras la muerte. Analizaremos las distintas formas de sucesión (testamentaria e intestada) y figuras como el legado y los fideicomisos.</p></div><details class="infografia-container"><summary><span>📊 Ver Infografía: Tipos de Sucesión</span><svg class="w-6 h-6 infografia-arrow" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M19.5 8.25l-7.5 7.5-7.5-7.5"></path></svg></summary><div class="infografia-content grid grid-cols-1 md:grid-cols-2 gap-4"><div class="bg-slate-100 p-4 rounded-lg"><h4 class="font-bold text-primary">Sucesión Testamentaria</h4><ul class="text-sm text-secondary list-disc list-inside"><li>Se rige por la **voluntad** del causante.</li><li>Instrumento clave: **Testamento**.</li><li>Principio: *Nemo pro parte testatus pro parte intestatus decedere potest*.</li></ul></div><div class="bg-slate-100 p-4 rounded-lg"><h4 class="font-bold text-primary">Sucesión Intestada (ab Intestato)</h4><ul class="text-sm text-secondary list-disc list-inside"><li>Se aplica en **ausencia** de testamento válido.</li><li>El Derecho establece el **orden** de herederos.</li><li>Se basa en el parentesco agnaticio (vínculo de poder).</li></ul></div></div></details><div class="space-y-4 mt-8"><div class="topic-card"><h4 class="text-xl font-semibold text-primary mb-2 font-heading">Tema 15: Sucesión testamentaria</h4><p class="text-secondary mb-3 text-sm">Estudio del testamento, sus clases, elementos y validez.</p><div class="topic-links flex flex-wrap gap-4"><a href="15. testamentaria.pdf" target="_blank" class="topic-link-button"><svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M4 4a2 2 0 012-2h4.586A2 2 0 0112 2.586L15.414 6A2 2 0 0116 7.414V16a2 2 0 01-2 2H6a2 2 0 01-2-2V4zm2 6a1 1 0 011-1h6a1 1 0 110 2H7a1 1 0 01-1-1zm1 3a1 1 0 100 2h6a1 1 0 100-2H7z" clip-rule="evenodd" /></svg><span>Ver Guion</span></a><a href="https://open.spotify.com/episode/6D2mPBSBGo8AcyGWXO914i?si=btU9P3-nRryXxr_vFvu0Kw2" target="_blank" class="topic-link-button"><svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor"><path d="M10 18a8 8 0 100-16 8 8 0 000 16zM9.555 7.168A1 1 0 008 8v4a1 1 0 001.555.832l3-2a1 1 0 000-1.664l-3-2z" /></svg><span>Escuchar Podcast</span></a></div></div><div class="topic-card"><h4 class="text-xl font-semibold text-primary mb-2 font-heading">Tema 16: Legados y fideicomisos</h4><p class="text-secondary mb-3 text-sm">Análisis de las disposiciones mortis causa a título particular (legados) y los ruegos de confianza (fideicomisos).</p><div class="topic-links flex flex-wrap gap-4"><a href="16. legados.pdf" target="_blank" class="topic-link-button"><svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M4 4a2 2 0 012-2h4.586A2 2 0 0112 2.586L15.414 6A2 2 0 0116 7.414V16a2 2 0 01-2 2H6a2 2 0 01-2-2V4zm2 6a1 1 0 011-1h6a1 1 0 110 2H7a1 1 0 01-1-1zm1 3a1 1 0 100 2h6a1 1 0 100-2H7z" clip-rule="evenodd" /></svg><span>Ver Guion</span></a><a href="https://open.spotify.com/episode/6D2mPBSBGo8AcyGWXO914i?si=btU9P3-nRryXxr_vFvu0Kw3" target="_blank" class="topic-link-button"><svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor"><path d="M10 18a8 8 0 100-16 8 8 0 000 16zM9.555 7.168A1 1 0 008 8v4a1 1 0 001.555.832l3-2a1 1 0 000-1.664l-3-2z" /></svg><span>Escuchar Podcast</span></a></div></div></div>` 
            },
            '#bibliografia': {
                title: 'Recursos',
                html: `<div class="prose"><h2 class="text-3xl font-bold text-secondary mb-4 !mt-0">Recursos y Bibliografía</h2><p class="text-secondary">Esta sección ofrece una lista de recursos esenciales para profundizar en la asignatura.</p><h3 class="text-2xl font-semibold text-primary mt-8 mb-4">Manual Básico</h3><ul class="text-secondary list-disc list-inside space-y-2"><li>**Nombre del Manual:** Instituciones de Derecho Romano (Edición adaptada).</li><li>**Autores:** XXXXX.</li><li>**Editorial:** XXXXX.</li></ul><h3 class="text-2xl font-semibold text-primary mt-8 mb-4">Compilación de Fuentes</h3><ul class="text-secondary list-disc list-inside space-y-2"><li>**Corpus Iuris Civilis:** Edición de referencia, disponible en la Biblioteca de la Universidad.</li><li>**Fragmenta Vaticana:** Colección de textos jurisprudenciales.</li></ul><h3 class="text-2xl font-semibold text-primary mt-8 mb-4">Recursos Online</h3><ul class="text-secondary list-disc list-inside space-y-2"><li><a href="https://webs.um.es/adiaz-bautista/" target="_blank" rel="noopener noreferrer" class="text-amber-600 hover:underline">Web personal del profesor</a></li><li><a href="http://googleusercontent.com/spotify.com/podcast" target="_blank" rel="noopener noreferrer" class="text-amber-600 hover:underline">Podcast "Derecho Romano para Inquietos"</a></li></ul></div>`
            }
        };


        // ========================================
        // GESTIÓN DE EVENTOS DE INTERFAZ
        // ========================================

        // Función para renderizar el contenido
        function renderContent(hash) {
            const page = contentMap[hash] || contentMap['#home'];
            document.title = `${page.title} | Guía Interactiva de Derecho Romano`;
            contentArea.innerHTML = page.html;
            
            // Actualizar clase activa del sidebar
            document.querySelectorAll('.sidebar-link').forEach(link => {
                link.classList.remove('sidebar-link-active');
            });
            const activeLink = document.querySelector(`.sidebar-link[href="${hash}"]`);
            if (activeLink) {
                activeLink.classList.add('sidebar-link-active');
            } else {
                 document.querySelector('.sidebar-link[href="#home"]').classList.add('sidebar-link-active');
            }

            // Cerrar sidebar en móviles tras navegación
            if (sidebar.classList.contains('translate-x-0')) {
                 toggleSidebar();
            }

            // Inicializar funcionalidades específicas de las páginas
            if (hash === '#caselab') {
                initCaseLabPage();
            } else if (hash === '#ulpiano') {
                initUlpianoPage();
            } else if (hash === '#home') {
                 initHomePage();
            }
        }

        // Manejar el cambio de hash
        function handleHashChange() {
            renderContent(window.location.hash || '#home');
        }

        // Toggle del sidebar para móviles
        function toggleSidebar() {
            sidebar.classList.toggle('-translate-x-full');
            sidebarOverlay.classList.toggle('hidden');
            menuButton.setAttribute('aria-expanded', sidebar.classList.contains('translate-x-0'));
        }

        // Inicialización de la Home Page (para el video)
        function initHomePage() {
            const openVideoBtn = document.getElementById('open-video-modal-btn');
            const closeVideoBtn = document.getElementById('close-video-modal-btn');
            const videoModal = document.getElementById('video-modal');
            const videoPlayer = document.getElementById('modal-video-player');

            if (openVideoBtn) {
                openVideoBtn.addEventListener('click', () => {
                    videoModal.classList.remove('hidden');
                    videoPlayer.play();
                });
            }

            if (closeVideoBtn) {
                closeVideoBtn.addEventListener('click', () => {
                    videoModal.classList.add('hidden');
                    videoPlayer.pause();
                    videoPlayer.currentTime = 0; // Reiniciar el video
                });
            }

            // Cerrar modal al hacer clic en el overlay
            videoModal.addEventListener('click', (e) => {
                if (e.target === videoModal) {
                    closeVideoBtn.click();
                }
            });
        }


        // Inicialización de la página de UlpianoIA
        function initUlpianoPage() {
            const queryInput = document.getElementById('queryInput');
            const submitQueryBtn = document.getElementById('submitQueryBtn');
            const queryResult = document.getElementById('queryResult');
            const queryResultText = document.getElementById('queryResultText');
            const submitBtnText = document.getElementById('submit-btn-text');
            const submitBtnLoader = document.getElementById('submit-btn-loader');
            
            submitQueryBtn.addEventListener('click', async () => {
                const userQuery = queryInput.value.trim();
                queryResult.classList.remove('hidden');
                queryResultText.innerHTML = '';
                
                if (userQuery === "") {
                    showError(queryResultText, "Por favor, introduce tu pregunta.");
                    return;
                }
                
                showLoading(queryResultText, 'UlpianoIA está consultando las fuentes clásicas...');

                // Llamada a la API envuelta en el manejador de carga
                const respuestaPrincipalResult = await handleButtonLoading(
                    submitQueryBtn, submitBtnLoader, submitBtnText,
                    async () => {
                         // Se elimina la llamada directa a callGeminiAPI para centralizarla en el Promise.all
                         // y se mueve la lógica de Promise.all al interior del handler para manejar el loading
                         // y las 3 llamadas concurrentemente.
                         
                         // Las 3 peticiones se lanzan en paralelo
                         const [
                            respuestaPrincipalResult, 
                            respuestaModerno,
                            respuestaPagina
                        ] = await Promise.all([
                            callGeminiAPI(`pregunta teórica`, userQuery),              
                            callApiAndHandleErrors('derecho-moderno', { termino: userQuery }),
                            callApiAndHandleErrors('buscar-pagina', { termino: userQuery })
                        ]);
                        
                        let resultadoFinal = [];
                        resultadoFinal.push(`**Respuesta Jurídica:**\n${respuestaPrincipalResult.respuesta || `Error: ${respuestaPrincipalResult.error}`}`);
                        
                        // Se elimina el bloque 'if' que comprobaba la fuente clásica
                        
                        if (respuestaModerno && respuestaModerno.moderno) {
                            resultadoFinal.push(`**Vigencia en el Derecho Moderno:**\n${respuestaModerno.moderno}`);
                        }
                        
                        if (respuestaPagina && respuestaPagina.pagina) {
                            resultadoFinal.push(`**Para saber más:**\nPuedes consultar el tema "${respuestaPagina.titulo}" en la página ${respuestaPagina.pagina} del manual.`);
                        }
                        
                        const textoFinal = resultadoFinal.join('\n\n');
                        queryResultText.innerHTML = sanitizeHTML(textoFinal).replace(/\n/g, '<br>').replace(/\*\*(.*?)\*\*/g, '<strong>$1</strong>');
                        
                        // Retornamos solo para satisfacer el handleButtonLoading, aunque la UI ya se actualizó
                        return { success: true }; 
                    }
                );

            });
        }

        // Inicialización de la página CaseLab
        function initCaseLabPage() {
            const caseInput = document.getElementById('case-study-input');
            const generateBtn = document.getElementById('generate-case-btn');
            const solveBtn = document.getElementById('solve-case-btn');
            const caseResult = document.getElementById('case-study-result');
            const solutionResult = document.getElementById('case-solution-result');
            const btnText = document.getElementById('btn-text');
            const btnLoader = document.getElementById('btn-loader');
            const solveBtnText = document.getElementById('solve-btn-text');
            const solveBtnLoader = document.getElementById('solve-btn-loader');
            
            let currentCaseText = '';

            // 1. GENERAR CASO
            generateBtn.addEventListener('click', async () => {
                const termino = caseInput.value.trim();
                solveBtn.classList.add('hidden');
                solutionResult.classList.add('hidden');
                caseResult.innerHTML = '';
                
                if (termino === "") {
                    showError(caseResult, "Por favor, introduce el concepto para generar el caso.");
                    return;
                }

                showLoading(caseResult, `Generando un caso de estudio sobre **${termino}**...`);
                
                const result = await handleButtonLoading(
                    generateBtn, btnLoader, btnText,
                    async () => {
                        return await callGeminiAPI(`generar caso`, termino);
                    }
                );

                if (result.error) {
                    showError(caseResult, result.error);
                    currentCaseText = '';
                } else {
                    currentCaseText = result.respuesta || 'No se pudo generar el caso.';
                    caseResult.innerHTML = sanitizeHTML(currentCaseText).replace(/\n/g, '<br>');
                    solveBtn.classList.remove('hidden');
                }
            });

            // 2. RESOLVER CASO
            solveBtn.addEventListener('click', async () => {
                 if (!currentCaseText) {
                    showError(solutionResult, "Primero debes generar un caso.");
                    return;
                }

                solutionResult.classList.remove('hidden');
                showLoading(solutionResult, 'UlpianoIA está resolviendo el caso de estudio...');

                const result = await handleButtonLoading(
                    solveBtn, solveBtnLoader, solveBtnText,
                    async () => {
                        return await callGeminiAPI(`resolver caso`, null, currentCaseText);
                    }
                );

                if (result.error) {
                    showError(solutionResult, result.error);
                } else {
                    solutionResult.innerHTML = `<h3 class="text-xl font-semibold mb-2 text-green-700">Solución Jurídica (UlpianoIA):</h3>` + 
                                               sanitizeHTML(result.respuesta || 'No se pudo generar la solución.').replace(/\n/g, '<br>');
                }
            });
        }


        // ========================================
        // INICIALIZACIÓN GLOBAL
        // ========================================
        
        // Event listeners para el sidebar
        menuButton.addEventListener('click', toggleSidebar);
        sidebarOverlay.addEventListener('click', toggleSidebar);
        window.addEventListener('hashchange', handleHashChange);

        // Renderizar la página inicial
        document.addEventListener('DOMContentLoaded', handleHashChange);
    </script>
</body>
</html>