<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Infografía: Contratos por Vínculo y Acción</title>
    <!-- Incluimos Tailwind CSS desde el CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* Usamos la fuente Inter, que es limpia y moderna */
        body {
            font-family: 'Inter', sans-serif;
        }
        /* Animación para las tarjetas */
        .info-card {
            transition: transform 0.2s ease-in-out, box-shadow 0.2s ease-in-out;
            display: flex;
            flex-direction: column;
            height: 100%; /* Asegura que las tarjetas en una fila tengan la misma altura */
        }
        .info-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
        }
        .info-card-content {
            flex-grow: 1; /* Hace que el contenido crezca para llenar el espacio */
        }
        /* Estilos para el modal y el loader */
        .modal {
            transition: opacity 0.25s ease;
        }
        .modal-content {
            transition: transform 0.25s ease;
        }
        .loader {
            border-top-color: #3498db;
            animation: spin 1s linear infinite;
        }
        @keyframes spin {
            to {
                transform: rotate(360deg);
            }
        }
    </style>
</head>
<body class="bg-slate-100 p-4 md:p-8 antialiased">

    <!-- Contenedor principal de la infografía -->
    <div class="max-w-7xl mx-auto bg-white shadow-2xl rounded-2xl overflow-hidden">
        
        <!-- Cabecera -->
        <header class="bg-gradient-to-r from-cyan-800 to-teal-700 p-6 md:p-8 text-white shadow-lg">
            <h1 class="text-2xl md:text-3xl font-bold">Clasificación de Contratos por Vínculo y Acción</h1>
            <p class="text-lg md:text-xl opacity-90 mt-1">Entendiendo las Acciones Únicas, Directas, Contrarias y Recíprocas</p>
        </header>

        <!-- Contenido principal: Las 3 Clases -->
        <main class="p-6 md:p-8">
            
            <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">

                <!-- Columna 1: Unilaterales -->
                <section class="info-card p-6 bg-slate-50 rounded-lg shadow-lg border-t-4 border-gray-500">
                    <div class="flex items-center mb-4">
                        <!-- Icono de "Una Dirección" -->
                        <div class="w-16 h-16 bg-gray-200 text-gray-700 rounded-full flex items-center justify-center mr-4 flex-shrink-0">
                            <svg xmlns="http://www.w3.org/2000/svg" class="w-8 h-8" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                                <path stroke-linecap="round" stroke-linejoin="round" d="M17 8l4 4m0 0l-4 4m4-4H3" />
                            </svg>
                        </div>
                        <h3 class="font-bold text-2xl text-gray-800">1. UNILATERALES</h3>
                    </div>
                    <div class="info-card-content">
                        <p class="text-lg text-slate-700 mb-4 font-semibold">
                            Crean obligaciones para <span class="font-bold text-gray-800">UNA SOLA PARTE</span> (el deudor).
                        </p>
                        <h4 class="font-bold text-slate-800 mb-2">Ejemplos:</h4>
                        <ul class="list-disc list-inside text-slate-600 space-y-3 mb-6">
                            <li class="flex justify-between items-center">
                                <span>Mutuo (Préstamo de consumo)</span>
                                <button onclick="generarCaso('Mutuo')" class="text-xs bg-cyan-600 text-white px-2 py-1 rounded-md hover:bg-cyan-700 transition-all flex-shrink-0">✨ Generar Caso</button>
                            </li>
                            <li class="flex justify-between items-center">
                                <span>Contratos Formales (*Stipulatio*)</span>
                                <button onclick="generarCaso('Stipulatio')" class="text-xs bg-cyan-600 text-white px-2 py-1 rounded-md hover:bg-cyan-700 transition-all flex-shrink-0">✨ Generar Caso</button>
                            </li>
                        </ul>

                        <h4 class="font-bold text-slate-800 mb-2">Lógica Procesal:</h4>
                        <div class="bg-white p-3 rounded-md shadow-sm border-l-2 border-gray-300">
                            <span class="font-semibold text-gray-700">Relación:</span> Acreedor → Deudor
                            <p class="text-lg font-bold text-gray-800 mt-2">ACCIÓN ÚNICA</p>
                            <p class="text-slate-600 text-sm">El acreedor tiene una acción para reclamar. (Ej: *Condictio* o *Actio ex Stipulatu*).</p>
                        </div>
                    </div>
                </section>

                <!-- Columna 2: Bilaterales Imperfectos -->
                <section class="info-card p-6 bg-cyan-50 rounded-lg shadow-lg border-t-4 border-cyan-600">
                    <div class="flex items-center mb-4">
                        <!-- Icono de "Dos Direcciones, una eventual" -->
                        <div class="w-16 h-16 bg-cyan-100 text-cyan-700 rounded-full flex items-center justify-center mr-4 flex-shrink-0">
                            <svg xmlns="http://www.w3.org/2000/svg" class="w-8 h-8" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                                <path stroke-linecap="round" stroke-linejoin="round" d="M17 8l4 4m0 0l-4 4m4-4H3m4 4H3m4-4h1.5" stroke-dasharray="4 4"/>
                            </svg>
                        </div>
                        <h3 class="font-bold text-2xl text-cyan-800">2. BILATERALES IMPERFECTOS</h3>
                    </div>
                    <div class="info-card-content">
                        <p class="text-lg text-slate-700 mb-4 font-semibold">
                            Crean una obligación <span class="font-bold text-cyan-800">SIEMPRE</span> para una parte (deudor), y solo <span class="font-bold text-cyan-800">EVENTUALMENTE</span> para la otra (acreedor, ej. para reembolsar gastos).
                        </p>
                        <h4 class="font-bold text-slate-800 mb-2">Ejemplos:</h4>
                        <ul class="list-disc list-inside text-slate-600 space-y-3 mb-6">
                            <li class="flex justify-between items-center">
                                <span>Comodato (Préstamo de uso)</span>
                                <button onclick="generarCaso('Comodato')" class="text-xs bg-cyan-600 text-white px-2 py-1 rounded-md hover:bg-cyan-700 transition-all flex-shrink-0">✨ Generar Caso</button>
                            </li>
                            <li class="flex justify-between items-center">
                                <span>Depósito</span>
                                <button onclick="generarCaso('Depósito')" class="text-xs bg-cyan-600 text-white px-2 py-1 rounded-md hover:bg-cyan-700 transition-all flex-shrink-0">✨ Generar Caso</button>
                            </li>
                            <li class="flex justify-between items-center">
                                <span>Prenda (*Pignus*)</span>
                                <button onclick="generarCaso('Pignus')" class="text-xs bg-cyan-600 text-white px-2 py-1 rounded-md hover:bg-cyan-700 transition-all flex-shrink-0">✨ Generar Caso</button>
                            </li>
                            <li class="flex justify-between items-center">
                                <span>Mandato</span>
                                <button onclick="generarCaso('Mandato')" class="text-xs bg-cyan-600 text-white px-2 py-1 rounded-md hover:bg-cyan-700 transition-all flex-shrink-0">✨ Generar Caso</button>
                            </li>
                        </ul>

                        <h4 class="font-bold text-slate-800 mb-2">Lógica Procesal:</h4>
                        <div class="bg-white p-3 rounded-md shadow-sm border-l-2 border-cyan-300">
                            <span class="font-semibold text-gray-700">Relación:</span> Acreedor ↔ Deudor
                            <p class="text-lg font-bold text-cyan-800 mt-2">ACCIÓN DIRECTA vs. CONTRARIA</p>
                            <p class="text-slate-600 text-sm"><span class="font-bold">Directa (Principal):</span> Del acreedor para reclamar la cosa/gestión. (Ej: *Actio Commodati Directa*).</p>
                            <p class="text-slate-600 text-sm mt-1"><span class="font-bold">Contraria (Eventual):</span> Del deudor para reclamar gastos. (Ej: *Actio Commodati Contraria*).</p>
                        </div>
                    </div>
                </section>

                <!-- Columna 3: Bilaterales Perfectos (Sinalagmáticos) -->
                <section class="info-card p-6 bg-teal-50 rounded-lg shadow-lg border-t-4 border-teal-600">
                    <div class="flex items-center mb-4">
                        <!-- Icono de "Dos Direcciones Iguales" -->
                        <div class="w-16 h-16 bg-teal-100 text-teal-700 rounded-full flex items-center justify-center mr-4 flex-shrink-0">
                            <svg xmlns="http://www.w3.org/2000/svg" class="w-8 h-8" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                                <path stroke-linecap="round" stroke-linejoin="round" d="M7 16l-4-4m0 0l4-4m-4 4h18m-1 4l4-4m0 0l-4-4m4 4H3" />
                            </svg>
                        </div>
                        <h3 class="font-bold text-2xl text-teal-800">3. BILATERALES PERFECTOS</h3>
                    </div>
                    <div class="info-card-content">
                        <p class="text-lg text-slate-700 mb-4 font-semibold">
                            Crean obligaciones <span class="font-bold text-teal-800">RECÍPROCAS</span> para <span class="font-bold text-teal-800">AMBAS PARTES</span> desde el inicio. La obligación de uno es la causa del otro.
                        </p>
                        <h4 class="font-bold text-slate-800 mb-2">Ejemplos:</h4>
                        <ul class="list-disc list-inside text-slate-600 space-y-3 mb-6">
                            <li class="flex justify-between items-center">
                                <span>Compraventa (*Emptio-Venditio*)</span>
                                <button onclick="generarCaso('Compraventa (Emptio-Venditio)')" class="text-xs bg-cyan-600 text-white px-2 py-1 rounded-md hover:bg-cyan-700 transition-all flex-shrink-0">✨ Generar Caso</button>
                            </li>
                            <li class="flex justify-between items-center">
                                <span>Arrendamiento (*Locatio-Conductio*)</span>
                                <button onclick="generarCaso('Arrendamiento (Locatio-Conductio)')" class="text-xs bg-cyan-600 text-white px-2 py-1 rounded-md hover:bg-cyan-700 transition-all flex-shrink-0">✨ Generar Caso</button>
                            </li>
                            <li class="flex justify-between items-center">
                                <span>Sociedad (*Societas*)</span>
                                <button onclick="generarCaso('Sociedad (Societas)')" class="text-xs bg-cyan-600 text-white px-2 py-1 rounded-md hover:bg-cyan-700 transition-all flex-shrink-0">✨ Generar Caso</button>
                            </li>
                        </ul>

                        <h4 class="font-bold text-slate-800 mb-2">Lógica Procesal:</h4>
                        <div class="bg-white p-3 rounded-md shadow-sm border-l-2 border-teal-300">
                            <span class="font-semibold text-gray-700">Relación:</span> Parte A ↔ Parte B
                            <p class="text-lg font-bold text-teal-800 mt-2">ACCIONES RECÍPROCAS</p>
                            <p class="text-slate-600 text-sm">Ambas partes tienen acciones principales e independientes. (Ej: *Actio Empti* para el comprador, *Actio Venditi* para el vendedor).</p>
                        </div>
                    </div>
                </section>

            </div>
        </main>
        
        <!-- Pie de página / Conclusión -->
        <footer class="p-6 md:p-8 bg-slate-100 border-t border-slate-200">
            <h3 class="text-xl font-bold text-slate-800 text-center">Conclusión Procesal: El Poder del Juez</h3>
            <div class="mt-4 grid grid-cols-1 md:grid-cols-2 gap-6 max-w-4xl mx-auto">
                <div class="bg-white p-4 rounded-lg shadow-md border-b-4 border-gray-500">
                    <h4 class="font-bold text-lg text-gray-800 text-center">Acciones de DERECHO ESTRICTO</h4>
                    <p class="text-slate-600 text-center text-sm mt-2">Nacidas de contratos **Unilaterales** (Mutuo, *Stipulatio*). El juez solo puede condenar o absolver según lo escrito en la fórmula.</p>
                </div>
                <div class="bg-white p-4 rounded-lg shadow-md border-b-4 border-teal-600">
                    <h4 class="font-bold text-lg text-teal-800 text-center">Acciones de BUENA FE (*Ex Fide Bona*)</h4>
                    <p class="text-slate-600 text-center text-sm mt-2">Nacidas de contratos **Bilaterales** (Compraventa, Depósito, etc.). El juez tiene un amplio arbitrio para valorar la equidad y compensar deudas.</p>
                </div>
            </div>
        </footer>

    </div>

    <!-- Modal para mostrar la respuesta de Gemini -->
    <div id="geminiModal" class="modal fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50 opacity-0 pointer-events-none">
        <div class="modal-content bg-white rounded-lg shadow-lg w-11/12 md:w-1/2 lg:w-1/3 p-6 transform scale-95">
            <div class="flex justify-between items-center mb-4">
                <h3 id="modalTitle" class="text-xl font-bold text-gray-800"></h3>
                <button onclick="closeModal()" class="text-gray-500 hover:text-gray-800 text-3xl">&times;</button>
            </div>
            <div id="modalBody" class="text-slate-700 whitespace-pre-wrap overflow-y-auto max-h-96">
                <!-- El contenido generado por Gemini irá aquí -->
            </div>
            <div class="text-right mt-6">
                <button onclick="closeModal()" class="bg-cyan-700 text-white px-4 py-2 rounded-lg hover:bg-cyan-800 transition-all">Cerrar</button>
            </div>
        </div>
    </div>

    <!-- Overlay de carga -->
    <div id="loader" class="fixed inset-0 z-60 flex items-center justify-center bg-black bg-opacity-25 hidden">
        <div class="loader ease-linear rounded-full border-8 border-t-8 border-gray-200 h-24 w-24"></div>
    </div>

    <script>
        const modal = document.getElementById('geminiModal');
        const modalTitle = document.getElementById('modalTitle');
        const modalBody = document.getElementById('modalBody');
        const loader = document.getElementById('loader');

        function openModal(title, content) {
            modalTitle.textContent = title;
            // Reemplaza los saltos de línea de texto con <br> y negritas
            let htmlContent = content.replace(/\*\*(.*?)\*\*/g, '<strong class="font-bold text-slate-800">$1</strong>');
            htmlContent = htmlContent.replace(/\n/g, '<br>');
            modalBody.innerHTML = htmlContent;
            
            modal.classList.remove('opacity-0', 'pointer-events-none');
            modal.querySelector('.modal-content').classList.remove('scale-95');
        }

        function closeModal() {
            modal.querySelector('.modal-content').classList.add('scale-95');
            modal.classList.add('opacity-0', 'pointer-events-none');
        }

        function showLoader() {
            loader.classList.remove('hidden');
        }

        function hideLoader() {
            loader.classList.add('hidden');
        }

        // Función principal para llamar a Gemini
        async function generarCaso(tipoContrato) {
            showLoader();
            
            const prompt = `Eres un profesor experto en Derecho Romano, discípulo de Gayo y Papiniano. Genera un breve y claro caso práctico (casus) para un estudiante de primer año que involucre un contrato de '${tipoContrato}'. 
Después del caso, proporciona una 'Responsa' (solución) clara y concisa en un párrafo, explicando la acción o acciones legales que proceden y por qué.

Formato:
**Caso:** [Tu caso aquí]

**Solución (Responsa):** [Tu solución aquí]`;

            try {
                const response = await callGeminiAPI(prompt);
                hideLoader();
                openModal(`Caso Práctico: ${tipoContrato}`, response);
            } catch (error) {
                hideLoader();
                openModal('Error', 'No se pudo generar el caso práctico en este momento. Por favor, inténtelo de nuevo más tarde.');
            }
        }

        // Función de llamada a la API con reintentos (backoff exponencial)
        async function callGeminiAPI(prompt, retries = 3, delay = 1000) {
            const apiKey = ""; // Dejar vacío, se gestionará en el entorno
            const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-09-2025:generateContent?key=${apiKey}`;

            const payload = {
                contents: [{ parts: [{ text: prompt }] }],
            };

            for (let i = 0; i < retries; i++) {
                try {
                    const response = await fetch(apiUrl, {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify(payload)
                    });

                    if (!response.ok) {
                        throw new Error(`Error en la API: ${response.statusText}`);
                    }

                    const result = await response.json();
                    
                    if (result.candidates && result.candidates.length > 0 &&
                        result.candidates[0].content && result.candidates[0].content.parts &&
                        result.candidates[0].content.parts.length > 0) {
                        return result.candidates[0].content.parts[0].text;
                    } else {
                        throw new Error('Respuesta inesperada de la API.');
                    }

                } catch (error) {
                    if (i === retries - 1) {
                        console.error('Error al llamar a la API de Gemini:', error);
                        throw error;
                    }
                    // Espera exponencial antes de reintentar
                    await new Promise(res => setTimeout(res, delay * Math.pow(2, i)));
                }
            }
            throw new Error('No se pudo obtener respuesta de la API después de varios intentos.');
        }

        // Cerrar modal si se hace clic fuera
        window.onclick = function(event) {
            if (event.target == modal) {
                closeModal();
            }
        }
    </script>

</body>
</html>