<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Infografía: Clases de Servidumbres Prediales Romanas</title>
    <!-- Incluimos Tailwind CSS desde el CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* Usamos la fuente Inter, que es limpia y moderna */
        body {
            font-family: 'Inter', sans-serif;
        }
        /* Animación para las tarjetas */
        .info-card {
            transition: transform 0.2s ease-in-out, box-shadow 0.2s ease-in-out;
        }
        .info-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
        }
        /* Estilos para el modal y el loader */
        .modal {
            transition: opacity 0.25s ease;
        }
        .modal-content {
            transition: transform 0.25s ease;
        }
        .loader {
            border-top-color: #15803d; /* green-700 */
            animation: spin 1s linear infinite;
        }
        @keyframes spin {
            to {
                transform: rotate(360deg);
            }
        }
    </style>
</head>
<body class="bg-slate-100 p-4 md:p-8 antialiased">

    <!-- Contenedor principal de la infografía -->
    <div class="max-w-6xl mx-auto bg-white shadow-2xl rounded-2xl overflow-hidden">
        
        <!-- Cabecera -->
        <header class="bg-gradient-to-r from-green-800 to-lime-700 p-6 md:p-8 text-white shadow-lg">
            <h1 class="text-2xl md:text-3xl font-bold">Clases de Servidumbres Prediales</h1>
            <p class="text-lg md:text-xl opacity-90 mt-1">La Clasificación Clásica (Rústicas y Urbanas) y Otras</p>
        </header>

        <!-- Contenido principal -->
        <main class="p-6 md:p-8">

            <!-- Sección 1: La Distinción Clásica Más Importante -->
            <section class="mb-10">
                <h2 class="text-2xl md:text-3xl font-semibold text-slate-800 border-b-2 border-green-400 pb-3 mb-6">
                    La Distinción Clásica Principal
                </h2>
                
                <div class="grid grid-cols-1 md:grid-cols-2 gap-8">

                    <!-- TARJETA: Rústicas -->
                    <div class="info-card flex flex-col p-6 bg-green-50 rounded-lg shadow-lg border-t-4 border-green-600">
                        <div class="flex items-center mb-4">
                            <!-- Icono de "Planta/Campo" -->
                            <div class="w-16 h-16 bg-green-100 text-green-700 rounded-full flex items-center justify-center mr-4 flex-shrink-0">
                                <svg xmlns="http://www.w3.org/2000/svg" class="w-8 h-8" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                                    <path stroke-linecap="round" stroke-linejoin="round" d="M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 016-6h6m6 3a4 4 0 100-5.292M18 21h-3v-1a6 6 0 00-6-6h-3" />
                                    <path stroke-linecap="round" stroke-linejoin="round" d="M14.121 15.879l-4.242 4.242a1 1 0 01-1.414 0l-4.242-4.242a1 1 0 010-1.414l4.242-4.242a1 1 0 011.414 0l4.242 4.242a1 1 0 010 1.414z" opacity="0.4" />
                                </svg>
                            </div>
                            <h3 class="font-bold text-2xl text-green-800">1. RÚSTICAS</h3>
                        </div>
                        <p class="text-lg text-slate-700 mb-4">
                            En interés de la <span class="font-semibold">agricultura y la ganadería</span>.
                        </p>
                        <p class="text-lg font-semibold text-green-900 bg-green-200 p-2 rounded-md inline-block mb-4">
                            Eran <span class="font-bold">Res Mancipi</span>.
                        </p>
                        
                        <div class="mt-2 space-y-3 flex-grow">
                            <h4 class="font-bold text-slate-800">Ejemplos:</h4>
                            <div class="bg-white p-3 rounded-md shadow-sm border-l-2 border-green-300 flex justify-between items-center">
                                <div>
                                    <span class="font-semibold text-green-700">De Paso:</span> <span class="text-slate-600">*Iter* (a pie), *Actus* (ganado), *Via* (camino).</span>
                                </div>
                                <button onclick="generarCaso('Servidumbre de Paso (Iter/Via)')" class="text-xs bg-green-700 text-white px-2 py-1 rounded-md hover:bg-green-800 transition-all flex-shrink-0 ml-2">✨ Generar Caso</button>
                            </div>
                            <div class="bg-white p-3 rounded-md shadow-sm border-l-2 border-green-300 flex justify-between items-center">
                                <div>
                                    <span class="font-semibold text-green-700">De Aguas:</span> <span class="text-slate-600">*Aquaeductus* (conducir), *Aquae haustus* (sacar).</span>
                                </div>
                                <button onclick="generarCaso('Servidumbre de Acueducto (Aquaeductus)')" class="text-xs bg-green-700 text-white px-2 py-1 rounded-md hover:bg-green-800 transition-all flex-shrink-0 ml-2">✨ Generar Caso</button>
                            </div>
                        </div>
                    </div>

                    <!-- TARJETA: Urbanas -->
                    <div class="info-card flex flex-col p-6 bg-slate-50 rounded-lg shadow-lg border-t-4 border-gray-600">
                        <div class="flex items-center mb-4">
                            <!-- Icono de "Edificio" -->
                            <div class="w-16 h-16 bg-gray-200 text-gray-700 rounded-full flex items-center justify-center mr-4 flex-shrink-0">
                                <svg xmlns="http://www.w3.org/2000/svg" class="w-8 h-8" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                                    <path stroke-linecap="round" stroke-linejoin="round" d="M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4" />
                                </svg>
                            </div>
                            <h3 class="font-bold text-2xl text-gray-800">2. URBANAS</h3>
                        </div>
                        <p class="text-lg text-slate-700 mb-4">
                            En interés de la <span class="font-semibold">edificación</span>.
                        </p>
                        <p class="text-lg font-semibold text-gray-900 bg-gray-200 p-2 rounded-md inline-block mb-4">
                            Eran <span class="font-bold">Res Nec Mancipi</span>.
                        </p>
                        
                        <div class="mt-2 space-y-3 flex-grow">
                            <h4 class="font-bold text-slate-800">Ejemplos:</h4>
                            <div class="bg-white p-3 rounded-md shadow-sm border-l-2 border-gray-300 flex justify-between items-center">
                                <div>
                                    <span class="font-semibold text-gray-700">De Luces y Vistas:</span> <span class="text-slate-600">*Ius prohibendi* de no elevar, abrir ventanas.</span>
                                </div>
                                <button onclick="generarCaso('Servidumbre de No Elevar (ius altius non tollendi)')" class="text-xs bg-green-700 text-white px-2 py-1 rounded-md hover:bg-green-800 transition-all flex-shrink-0 ml-2">✨ Generar Caso</button>
                            </div>
                            <div class="bg-white p-3 rounded-md shadow-sm border-l-2 border-gray-300 flex justify-between items-center">
                                <div>
                                    <span class="font-semibold text-gray-700">De Desagüe:</span> <span class="text-slate-600">Verter lluvia del tejado (*stillicidii*).</span>
                                </div>
                                <button onclick="generarCaso('Servidumbre de Desagüe (stillicidii)')" class="text-xs bg-green-700 text-white px-2 py-1 rounded-md hover:bg-green-800 transition-all flex-shrink-0 ml-2">✨ Generar Caso</button>
                            </div>
                            <div class="bg-white p-3 rounded-md shadow-sm border-l-2 border-gray-300 flex justify-between items-center">
                                <div>
                                    <span class="font-semibold text-gray-700">De Apoyo:</span> <span class="text-slate-600">Apoyo de viga (*oneris ferendi*), introducir viga (*immitendi*).</span>
                                </div>
                                <button onclick="generarCaso('Servidumbre de Apoyo (oneris ferendi)')" class="text-xs bg-green-700 text-white px-2 py-1 rounded-md hover:bg-green-800 transition-all flex-shrink-0 ml-2">✨ Generar Caso</button>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Sección 2: Otras Clasificaciones -->
            <section>
                <h2 class="text-2xl md:text-3xl font-semibold text-slate-800 border-b-2 border-green-400 pb-3 mb-6">
                    Otras Clasificaciones
                </h2>
                
                <div class="grid grid-cols-1 md:grid-cols-3 gap-6">

                    <!-- Tarjeta: Positivas / Negativas -->
                    <div class="info-card p-5 bg-slate-50 rounded-lg shadow-md border-t-4 border-blue-500">
                        <h3 class="font-bold text-lg text-blue-800 mb-3">Positivas vs. Negativas</h3>
                        <div class="space-y-2">
                            <p class="text-slate-700"><span class="font-semibold text-blue-700">Positivas:</span> El dominante <span class="font-bold">puede hacer algo</span> (una *immissio*) en el sirviente (Ej. servidumbre de paso).</p>
                            <p class="text-slate-700"><span class="font-semibold text-blue-700">Negativas:</span> El dominante <span class="font-bold">puede prohibir</span> (*ius prohibendi*) al sirviente hacer algo en su propia finca (Ej. no elevar edificación).</p>
                        </div>
                    </div>
                    
                    <!-- Tarjeta: Continuas / Discontinuas -->
                    <div class="info-card p-5 bg-slate-50 rounded-lg shadow-md border-t-4 border-purple-500">
                        <h3 class="font-bold text-lg text-purple-800 mb-3">Continuas vs. Discontinuas</h3>
                        <div class="space-y-2">
                            <p class="text-slate-700"><span class="font-semibold text-purple-700">Continuas:</span> Su uso es <span class="font-bold">incesante</span>, sin acto humano (Ej. acueducto, el agua pasa siempre).</p>
                            <p class="text-slate-700"><span class="font-semibold text-purple-700">Discontinuas:</span> <span class="font-bold">Requieren un acto humano</span> para su ejercicio (Ej. servidumbre de paso).</p>
                        </div>
                    </div>

                    <!-- Tarjeta: Aparentes / No Aparentes -->
                    <div class="info-card p-5 bg-slate-50 rounded-lg shadow-md border-t-4 border-orange-500">
                        <h3 class="font-bold text-lg text-orange-800 mb-3">Aparentes vs. No Aparentes</h3>
                        <div class="space-y-2">
                            <p class="text-slate-700"><span class="font-semibold text-orange-700">Aparentes:</span> Se manifiestan por <span class="font-bold">signos físicos visibles</span> (Ej. un camino, un acueducto).</p>
                            <p class="text-slate-700"><span class="font-semibold text-orange-700">No Aparentes:</span> <span class="font-bold">No hay signos visibles</span> (Ej. la servidumbre de no elevar la edificación).</p>
                        </div>
                    </div>
                </div>
            </section>

        </main>
    </div>

    <!-- Modal para mostrar la respuesta de Gemini -->
    <div id="geminiModal" class="modal fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50 opacity-0 pointer-events-none">
        <div class="modal-content bg-white rounded-lg shadow-lg w-11/12 md:w-1/2 lg:w-1/3 p-6 transform scale-95">
            <div class="flex justify-between items-center mb-4">
                <h3 id="modalTitle" class="text-xl font-bold text-gray-800"></h3>
                <button onclick="closeModal()" class="text-gray-500 hover:text-gray-800 text-3xl">&times;</button>
            </div>
            <div id="modalBody" class="text-slate-700 whitespace-pre-wrap overflow-y-auto max-h-96">
                <!-- El contenido generado por Gemini irá aquí -->
            </div>
            <div class="text-right mt-6">
                <button onclick="closeModal()" class="bg-green-700 text-white px-4 py-2 rounded-lg hover:bg-green-800 transition-all">Cerrar</button>
            </div>
        </div>
    </div>

    <!-- Overlay de carga -->
    <div id="loader" class="fixed inset-0 z-60 flex items-center justify-center bg-black bg-opacity-25 hidden">
        <div class="loader ease-linear rounded-full border-8 border-t-8 border-gray-200 h-24 w-24"></div>
    </div>

    <script>
        const modal = document.getElementById('geminiModal');
        const modalTitle = document.getElementById('modalTitle');
        const modalBody = document.getElementById('modalBody');
        const loader = document.getElementById('loader');

        function openModal(title, content) {
            modalTitle.textContent = title;
            // Reemplaza los saltos de línea de texto con <br> y negritas
            let htmlContent = content.replace(/\*\*(.*?)\*\*/g, '<strong class="font-bold text-slate-800">$1</strong>');
            htmlContent = htmlContent.replace(/\n/g, '<br>');
            modalBody.innerHTML = htmlContent;
            
            modal.classList.remove('opacity-0', 'pointer-events-none');
            modal.querySelector('.modal-content').classList.remove('scale-95');
        }

        function closeModal() {
            modal.querySelector('.modal-content').classList.add('scale-95');
            modal.classList.add('opacity-0', 'pointer-events-none');
        }

        function showLoader() {
            loader.classList.remove('hidden');
        }

        function hideLoader() {
            loader.classList.add('hidden');
        }
        
        // Función de prompt personalizada
        function getPromptForTopic(topic) {
            const basePrompt = `Eres un profesor experto en Derecho Romano. Genera un breve caso práctico (casus) para un estudiante de primer año que involucre una '${topic}'.
Después del caso, proporciona una 'Responsa' (solución) clara y concisa en un párrafo, explicando la solución jurídica y la acción que procede (ej. 'Vindicatio Servitutis' o 'Acción Confesoria').

Formato:
**Caso:** [Tu caso aquí]
**Solución (Responsa):** [Tu solución aquí]`;

            switch(topic) {
                case 'Servidumbre de Paso (Iter/Via)':
                    return `Eres un profesor experto en Derecho Romano. Genera un breve caso práctico (casus) sobre una **Servidumbre de Paso (Iter o Via)**. Ticio (fundo dominante) tiene derecho a pasar por el fundo de Cayo (fundo sirviente) para llegar al camino público. Cayo decide construir un muro que bloquea el paso.
Después del caso, proporciona una 'Responsa' (solución) clara, explicando la acción que tiene Ticio (*Vindicatio Servitutis*) para defender su derecho.
Formato:
**Caso:** [Tu caso aquí]
**Solución (Responsa):** [Tu solución aquí]`;
                case 'Servidumbre de Acueducto (Aquaeductus)':
                    return `Eres un profesor experto en Derecho Romano. Genera un breve caso práctico (casus) sobre una **Servidumbre de Acueducto (Aquaeductus)**. Ticio tiene derecho a que un canal de agua para su riego pase por el fundo de Cayo. Cayo realiza obras en su fundo y rompe el canal, impidiendo que llegue el agua.
Después del caso, proporciona una 'Responsa' (solución) clara, explicando la acción que tiene Ticio.
Formato:
**Caso:** [Tu caso aquí]
**Solución (Responsa):** [Tu solución aquí]`;
                case 'Servidumbre de No Elevar (ius altius non tollendi)':
                    return `Eres un profesor experto en Derecho Romano. Genera un breve caso práctico (casus) sobre una **Servidumbre Negativa (ius altius non tollendi)**. Ticio (fundo dominante) tiene derecho a que su vecino Cayo (fundo sirviente) no eleve su edificación para no quitarle las vistas. Cayo comienza a construir un segundo piso.
Después del caso, proporciona una 'Responsa' (solución) clara, explicando cómo puede Ticio paralizar la obra (*novi operis nuntiatio*) y defender su derecho (*Acción Confesoria*).
Formato:
**Caso:** [Tu caso aquí]
**Solución (Responsa):** [Tu solución aquí]`;
                case 'Servidumbre de Desagüe (stillicidii)':
                    return basePrompt.replace('${topic}', 'Servidumbre de Desagüe (stillicidii)');
                case 'Servidumbre de Apoyo (oneris ferendi)':
                    return `Eres un profesor experto en Derecho Romano. Genera un breve caso práctico (casus) sobre la **Servidumbre de Apoyo de Viga (oneris ferendi)**. La viga principal de la casa de Ticio se apoya en el muro de Cayo. El muro de Cayo amenaza ruina por falta de mantenimiento, y Cayo se niega a repararlo.
Después del caso, proporciona una 'Responsa' (solución) clara, explicando la particularidad de esta servidumbre (que SÍ implica un 'hacer' por parte del sirviente).
Formato:
**Caso:** [Tu caso aquí]
**Solución (Responsa):** [Tu solución aquí]`;
                default:
                    return basePrompt.replace('${topic}', topic);
            }
        }

        // Función principal para llamar a Gemini
        async function generarCaso(tipoCaso) {
            showLoader();
            
            const prompt = getPromptForTopic(tipoCaso);

            try {
                const response = await callGeminiAPI(prompt);
                hideLoader();
                openModal(`Caso Práctico: ${tipoCaso}`, response);
            } catch (error) {
                hideLoader();
                openModal('Error', 'No se pudo generar el caso práctico en este momento. Por favor, inténtelo de nuevo más tarde.');
            }
        }

        // Función de llamada a la API con reintentos (backoff exponencial)
        async function callGeminiAPI(prompt, retries = 3, delay = 1000) {
            const apiKey = ""; // Dejar vacío, se gestionará en el entorno
            const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-09-2025:generateContent?key=${apiKey}`;

            const payload = {
                contents: [{ parts: [{ text: prompt }] }],
            };

            for (let i = 0; i < retries; i++) {
                try {
                    const response = await fetch(apiUrl, {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify(payload)
                    });

                    if (!response.ok) {
                        throw new Error(`Error en la API: ${response.statusText}`);
                    }

                    const result = await response.json();
                    
                    if (result.candidates && result.candidates.length > 0 &&
                        result.candidates[0].content && result.candidates[0].content.parts &&
                        result.candidates[0].content.parts.length > 0) {
                        return result.candidates[0].content.parts[0].text;
                    } else {
                        throw new Error('Respuesta inesperada de la API.');
                    }

                } catch (error) {
                    if (i === retries - 1) {
                        console.error('Error al llamar a la API de Gemini:', error);
                        throw error;
                    }
                    // Espera exponencial antes de reintentar
                    await new Promise(res => setTimeout(res, delay * Math.pow(2, i)));
                }
            }
            throw new Error('No se pudo obtener respuesta de la API después de varios intentos.');
        }

        // Cerrar modal si se hace clic fuera
        window.onclick = function(event) {
            if (event.target == modal) {
                closeModal();
            }
        }
    </script>

</body>
</html>